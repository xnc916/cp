package com.xiongyuan.lottery.mypage.activity;

import android.content.DialogInterface;
import android.os.Bundle;
import android.text.Editable;
import android.text.InputType;
import android.text.TextWatcher;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.TextView;

import com.xiongyuan.lottery.R;
import com.xiongyuan.lottery.base.BaseActivity;
import com.xiongyuan.lottery.mypage.adapter.RegisterLinkList1Adapter;
import com.xiongyuan.lottery.mypage.dialog.RegisterDialog;
import com.xiongyuan.lottery.utils.ToastUtils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.regex.PatternSyntaxException;

import butterknife.BindView;
import butterknife.OnClick;
import cn.sharesdk.framework.ShareSDK;
import cn.sharesdk.onekeyshare.OnekeyShare;

public class RegisterLinkActivity extends BaseActivity {

    @BindView(R.id.title_name)
    TextView titleName;

    /*@BindView(R.id.regiter_link_lv_1)
    ListView lv1;*/
    @BindView(R.id.register_et_num_hight)
    EditText hightet;
    @BindView(R.id.register_et_num_short)
    EditText shortet;

    @BindView(R.id.regiter_link__bt_true)
    Button button;

    private RegisterLinkList1Adapter registerLinkList1Adapter;




    @Override
    public int getLayoutId() {
        ShareSDK.initSDK(this);
        return R.layout.activity_register_link;
    }

    @Override
    public void initView(Bundle savedInstanceState) {
        titleName.setText("生成注册链接");
        /*registerLinkList1Adapter = new RegisterLinkList1Adapter(this);
        lv1.setAdapter(registerLinkList1Adapter);*/
        initEdit();

    }

    private void initEdit() {
        hightet.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);
        shortet.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);

    }

    @Override
    public void initData() {

    }
    @OnClick({R.id.title_left,R.id.regiter_link__bt_true})
    public void click(View view) {
        switch (view.getId()) {
            case R.id.title_left:
                finish();
                break;
            case R.id.regiter_link__bt_true:
                double hightd = -1;
                double shortd = -1;
                String hights = hightet.getText().toString();
                if (!hights.equals("") && !hights.equals(null)){
                    hightd = Double.valueOf(hights);
                }
                String shorts = shortet.getText().toString();
                if (!shorts.equals("") && !shorts.equals(null)) {
                    shortd = Double.valueOf(shorts);
                }
                if (hightd < 5 | hightd >9 | shortd < 0 | shortd > 8){
                    if (hightd < 5 | hightd >9){
                        hightet.setText("");
                    }
                    if (shortd < 0 | shortd > 8){
                        shortet.setText("");
                    }
                    ToastUtils.showToast(this,"请根据提示输入数据。");
                    return;
                }

                RegisterDialog.Builder builder = new RegisterDialog.Builder(this);
                builder.setTitle("注册链接码");
                builder.setMessage("变了");
                builder.setcancelText("取消", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        dialog.dismiss();
                    }
                });
                builder.setshareText("分享", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        showShare();
                    }
                });
                builder.create().show();
                break;
        }
    }
    private void showShare() {
        OnekeyShare oks = new OnekeyShare();
        //关闭sso授权
        oks.disableSSOWhenAuthorize();
        // title标题，印象笔记、邮箱、信息、微信、人人网、QQ和QQ空间使用
        oks.setTitle("标题");

        // text是分享文本，所有平台都需要这个字段
        oks.setText("#猜猜乐#123");

        // url仅在微信（包括好友和朋友圈）中使用
        oks.setUrl("http://sharesdk.cn");

        // 启动分享GUI
        oks.show(this);
    }
    class SearchWather implements TextWatcher{

        private EditText editText;


        public SearchWather(EditText editText){
            this.editText = editText;
        }

        @Override
        public void onTextChanged(CharSequence ss, int start, int before, int count) {
            String editable = editText.getText().toString();
            String str = stringFilter(editable.toString());
            if(!editable.equals(str)){
                editText.setText(str);
                //设置新的光标所在位置
                editText.setSelection(str.length());
            }
        }

        @Override
        public void afterTextChanged(Editable s) {

        }
        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,int after) {

        }

    }
    public static String stringFilter(String str)throws PatternSyntaxException {
        // 只允许字母和数字
        String   regEx  =  "^[0-8]{1}(\\.[0-9]{1,2})$";
        Pattern p   =   Pattern.compile(regEx);
        Matcher m   =   p.matcher(str);
        return   m.replaceAll("").trim();
    }
}

